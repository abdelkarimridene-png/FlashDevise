<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FlashDevise | Terminal v9</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #05070a; color: white; font-family: 'Inter', sans-serif; }
        .panel { background: #0f141c; border: 1px solid #1e293b; border-radius: 1rem; }
        .news-item { border-bottom: 1px solid #1e293b; padding: 12px 0; transition: all 0.3s; }
        .news-item:hover { background: rgba(255,255,255,0.02); }
        .news-tag { font-size: 10px; color: #6366f1; font-weight: 800; text-transform: uppercase; }
        .loader { border-top-color: #6366f1; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-6xl mx-auto space-y-6">
        
        <div class="panel p-6 flex flex-col md:flex-row justify-between items-center gap-6">
            <div>
                <h1 class="font-black italic text-2xl uppercase italic">FLASH<span class="text-indigo-500">DEVISE</span></h1>
                <p class="text-[9px] opacity-30 uppercase tracking-[0.4em]">Direct Data Stream v9.0</p>
            </div>
            <div class="flex gap-3">
                <select id="sFrom" class="bg-slate-800 p-3 rounded-lg font-bold border-none text-white"></select>
                <select id="sTo" class="bg-slate-800 p-3 rounded-lg font-bold border-none text-white"></select>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
            
            <div class="lg:col-span-7">
                <div class="panel p-4 h-full">
                    <h2 class="text-xs font-bold opacity-50 uppercase tracking-widest mb-4">Analyse Graphique Temps Réel</h2>
                    <div id="chart-container" class="w-full h-[400px] rounded-lg overflow-hidden bg-black/20">
                        </div>
                </div>
            </div>

            <div class="lg:col-span-5">
                <div class="panel p-6 h-full">
                    <h2 class="text-xs font-bold opacity-50 uppercase tracking-widest mb-6">Dernières Actualités (Reuters / CNBC)</h2>
                    <div id="news-list" class="space-y-2 overflow-y-auto max-h-[400px] pr-2">
                        <div class="flex justify-center py-10">
                            <div class="loader ease-linear rounded-full border-2 border-t-2 border-gray-200 h-8 w-8"></div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        const assets = ["EUR", "USD", "GBP", "CHF", "BTC", "ETH", "XAU"];

        // Fonction pour charger les News via un proxy RSS (Google News Finance)
        async function loadNews(q) {
            const newsContainer = document.getElementById('news-list');
            try {
                // On utilise un service gratuit de conversion RSS vers JSON
                const res = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=https://news.google.com/rss/search?q=${q}+finance&hl=fr&gl=FR&ceid=FR:fr`);
                const data = await res.json();
                
                newsContainer.innerHTML = '';
                data.items.slice(0, 6).forEach(item => {
                    const date = new Date(item.pubDate).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                    newsContainer.innerHTML += `
                        <div class="news-item">
                            <div class="flex justify-between mb-1">
                                <span class="news-tag">${item.author || 'ÉCONOMIE'}</span>
                                <span class="text-[10px] opacity-40">${date}</span>
                            </div>
                            <a href="${item.link}" target="_blank" class="text-sm font-medium hover:text-indigo-400 leading-tight block">
                                ${item.title.split(' - ')[0]}
                            </a>
                        </div>
                    `;
                });
            } catch (e) {
                newsContainer.innerHTML = '<p class="text-xs opacity-50">Erreur de chargement des news.</p>';
            }
        }

        // Fonction pour charger le graphique (Via Image API pour éviter les blocages de scripts)
        function loadStaticChart(f, t) {
            const container = document.getElementById('chart-container');
            const pair = (f + t).toUpperCase();
            // On utilise l'URL de l'image générée dynamiquement par TradingView
            container.innerHTML = `<img src="https://s3.tradingview.com/snapshots/${pair.toLowerCase().charAt(0)}/${pair}.png" 
                                    onerror="this.src='https://via.placeholder.com/600x400/0f141c/FFFFFF?text=Analyse+${pair}+en+cours...'"
                                    class="w-full h-full object-cover opacity-80 hover:opacity-100 transition-opacity">`;
            
            // Si l'image snapshot n'est pas dispo, on tente l'iFrame ultra-basique
            container.innerHTML = `
                <iframe src="https://s.tradingview.com/widgetembed/?symbol=${pair}&interval=D&theme=dark" 
                style="width:100%; height:100%; border:none;"></iframe>
            `;
        }

        window.onload = function() {
            const sf = document.getElementById('sFrom'), st = document.getElementById('sTo');
            assets.forEach(a => { sf.add(new Option(a, a)); st.add(new Option(a, a)); });
            sf.value = "EUR"; st.value = "USD";
            
            const update = () => {
                loadNews(sf.value + "+" + st.value);
                loadStaticChart(sf.value, st.value);
            };
            
            [sf, st].forEach(el => el.onchange = update);
            update();
        }
    </script>
</body>
</html>
