<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FlashDevise | Terminal Financier</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    <style>
        body { font-family: sans-serif; background: #05070a; color: white; margin: 0; }
        .glass { background: rgba(15, 20, 28, 0.95); border: 1px solid rgba(255, 255, 255, 0.1); }
        #shareModal { display: none; background: rgba(0,0,0,0.9); position: fixed; inset: 0; z-index: 100; align-items: center; justify-content: center; }
        
        /* Simulation de logos sans images */
        .logo-box {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            border-radius: 6px;
            font-size: 10px;
            font-weight: 900;
            color: white;
            flex-shrink: 0;
        }
        .logo-binance { background: #F3BA2F; color: black; }
        .logo-wise { background: #00B9FF; }
        .logo-revolut { background: black; border: 1px solid #333; }
    </style>
</head>
<body class="p-4">

    <header class="max-w-6xl mx-auto flex justify-between py-8">
        <div class="font-black text-xl italic uppercase">FLASH<span class="text-indigo-500">DEVISE</span></div>
        <div class="text-[10px] font-bold opacity-30 uppercase tracking-[0.3em]">No-Image Terminal v2.0</div>
    </header>

    <main class="max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-8">
        <div class="lg:col-span-4 space-y-6">
            
            <div class="glass p-8 rounded-[2rem]">
                <input type="number" id="amount" value="1000" class="w-full bg-transparent text-4xl font-bold text-center mb-6 outline-none text-white">
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <select id="fromCurrency" class="bg-gray-800 p-3 rounded-xl text-white border-none"></select>
                    <select id="toCurrency" class="bg-gray-800 p-3 rounded-xl text-white border-none"></select>
                </div>
                <div id="resultValue" class="text-4xl font-black text-center mb-2 text-white">---</div>
                <div id="baseText" class="text-center text-indigo-400 text-[10px] uppercase font-bold tracking-widest italic">Calcul en cours...</div>
            </div>

            <div class="glass p-6 rounded-[2rem] text-center bg-indigo-500/5">
                <a id="mainAffiliateLink" href="#" target="_blank" class="flex items-center justify-center gap-3 w-full py-4 bg-white text-black rounded-xl font-bold text-xs uppercase hover:bg-gray-100 transition-all">
                    <div id="logoContainer" class="logo-box"></div>
                    <span id="mainAffText">Chargement...</span>
                </a>
            </div>
        </div>

        <div class="lg:col-span-8 h-[500px] glass rounded-[2rem] overflow-hidden">
            <div id="tradingview_chart" class="h-full w-full"></div>
        </div>
    </main>

    <div id="shareModal">
        <div class="glass p-10 rounded-[2rem] text-center max-w-sm w-full mx-4">
            <h2 class="text-2xl font-bold mb-6 text-white tracking-tighter">Taux Identifié</h2>
            <a id="modalAffiliateLink" href="#" target="_blank" class="flex items-center justify-center gap-3 w-full py-4 bg-indigo-600 text-white rounded-xl font-bold mb-6">
                <span id="modalAffText">Continuer</span>
            </a>
            <button onclick="closeModal()" class="text-gray-500 text-[10px] uppercase font-bold tracking-widest">Fermer</button>
        </div>
    </div>

    <script>
        function updateAffiliate(to) {
            const container = document.getElementById('logoContainer');
            const mainText = document.getElementById('mainAffText');
            const link = document.getElementById('mainAffiliateLink');
            const modalLink = document.getElementById('modalAffiliateLink');
            
            if (["BTC", "ETH", "SOL"].includes(to)) {
                container.className = "logo-box logo-binance";
                container.innerText = "B";
                mainText.innerText = "Vérifier sur Binance";
                link.href = "https://www.binance.com";
            } else if (to === "XAU") {
                container.className = "logo-box logo-revolut";
                container.innerText = "R";
                mainText.innerText = "Investir via Revolut";
                link.href = "https://www.revolut.com";
            } else {
                container.className = "logo-box logo-wise";
                container.innerText = "W";
                mainText.innerText = "Transférer via Wise";
                link.href = "https://wise.com";
            }
            modalLink.href = link.href;
        }

        function showModal() { document.getElementById('shareModal').style.display = 'flex'; }
        function closeModal() { document.getElementById('shareModal').style.display = 'none'; }

        async function convert() {
            const amount = document.getElementById('amount').value;
            const from = document.getElementById('fromCurrency').value;
            const to = document.getElementById('toCurrency').value;
            updateAffiliate(to);
            try {
                const res = await fetch(`https://api.exchangerate-api.com/v4/latest/${from}`);
                const data = await res.json();
                const rate = data.rates[to] || 1;
                document.getElementById('resultValue').innerText = (amount * rate).toLocaleString(undefined, {maximumFractionDigits:2}) + " " + to;
                document.getElementById('baseText').innerText = `1 ${from} = ${rate.toFixed(4)} ${to}`;
                setTimeout(showModal, 2500);
            } catch(e) { console.log(e); }
        }

        function updateChart() {
            const from = document.getElementById('fromCurrency').value;
            const to = document.getElementById('toCurrency').value;
            new TradingView.widget({
                "autosize": true, "symbol": `${from}${to}`, "interval": "D", "theme": "dark",
                "container_id": "tradingview_chart", "style": "3", "backgroundColor": "#05070a", "locale": "fr"
            });
        }

        async function init() {
            const fS = document.getElementById('fromCurrency'), tS = document.getElementById('toCurrency');
            const res = await fetch(`https://api.exchangerate-api.com/v4/latest/USD`);
            const data = await res.json();
            const codes = [...Object.keys(data.rates), "BTC", "ETH", "XAU"].sort();
            codes.forEach(c => { fS.add(new Option(c, c)); tS.add(new Option(c, c)); });
            fS.value = "EUR"; tS.value = "USD";
            
            [fS, tS].forEach(s => s.addEventListener('change', () => { convert(); updateChart(); }));
            document.getElementById('amount').addEventListener('input', convert);
            
            convert(); updateChart();
        }

        init();
    </script>
</body>
</html>
