<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FlashDevise Terminal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    <style>
        body { background: #05070a; color: white; font-family: sans-serif; }
        .glass { background: #0f141c; border: 1px solid #1e293b; border-radius: 24px; }
        
        /* Logos en texte pur : Impossible à bloquer */
        .fake-logo {
            width: 24px; height: 24px; border-radius: 4px;
            display: inline-flex; align-items: center; justify-content: center;
            font-weight: 900; font-size: 14px; margin-right: 10px;
        }
        .bg-wise { background: #00B9FF; color: white; }
        .bg-binance { background: #F3BA2F; color: black; }
        .bg-revolut { background: white; color: black; }
        .hidden { display: none !important; }
    </style>
</head>
<body class="p-4">

    <div class="max-w-xl mx-auto pt-10">
        <div class="text-[10px] text-center opacity-20 mb-4 uppercase tracking-widest">Version Mise à Jour : 10h18</div>
        
        <div class="glass p-6 shadow-2xl">
            <h1 class="text-center font-black italic mb-8 uppercase">FLASH<span class="text-indigo-500">DEVISE</span></h1>

            <div class="space-y-4">
                <input type="number" id="amount" value="1000" class="w-full bg-black/50 border border-white/10 p-4 rounded-xl text-3xl font-bold text-center outline-none">
                
                <div class="grid grid-cols-2 gap-4">
                    <select id="fromCurrency" class="bg-slate-800 p-3 rounded-xl border-none"></select>
                    <select id="toCurrency" class="bg-slate-800 p-3 rounded-xl border-none"></select>
                </div>

                <div class="py-8 text-center border-t border-white/5 mt-4">
                    <div id="resultValue" class="text-5xl font-black text-indigo-400">---</div>
                    <div id="baseText" class="text-xs opacity-40 mt-2 uppercase tracking-widest">Calcul en cours...</div>
                </div>

                <a id="affiliateLink" href="#" target="_blank" class="flex items-center justify-center w-full py-5 bg-white text-black rounded-2xl font-black text-sm uppercase">
                    <span id="logo-wise" class="fake-logo bg-wise">W</span>
                    <span id="logo-binance" class="fake-logo bg-binance hidden">B</span>
                    <span id="logo-revolut" class="fake-logo bg-revolut hidden">R</span>
                    <span id="btnText">Chargement...</span>
                </a>
            </div>
        </div>
    </div>

    <div class="max-w-xl mx-auto mt-6 h-64 glass overflow-hidden">
        <div id="tradingview_chart" class="h-full w-full"></div>
    </div>

    <script>
        const coins = ["EUR", "USD", "GBP", "BTC", "ETH", "XAU"];

        function updateUI(to) {
            const lWise = document.getElementById('logo-wise');
            const lBinance = document.getElementById('logo-binance');
            const lRevolut = document.getElementById('logo-revolut');
            const btnText = document.getElementById('btnText');
            const link = document.getElementById('affiliateLink');

            // On cache tout
            [lWise, lBinance, lRevolut].forEach(el => el.classList.add('hidden'));

            if (["BTC", "ETH"].includes(to)) {
                lBinance.classList.remove('hidden');
                btnText.innerText = "Vérifier sur Binance";
                link.href = "https://www.binance.com";
            } else if (to === "XAU") {
                lRevolut.classList.remove('hidden');
                btnText.innerText = "Investir via Revolut";
                link.href = "https://www.revolut.com";
            } else {
                lWise.classList.remove('hidden');
                btnText.innerText = "Transférer via Wise";
                link.href = "https://wise.com";
            }
        }

        async function convert() {
            const amount = document.getElementById('amount').value;
            const from = document.getElementById('fromCurrency').value;
            const to = document.getElementById('toCurrency').value;
            updateUI(to);

            try {
                const res = await fetch(`https://api.exchangerate-api.com/v4/latest/${from}`);
                const data = await res.json();
                const rate = data.rates[to];
                document.getElementById('resultValue').innerText = (amount * rate).toLocaleString() + " " + to;
                document.getElementById('baseText').innerText = `1 ${from} = ${rate.toFixed(4)} ${to}`;
                
                new TradingView.widget({
                    "autosize": true, "symbol": `${from}${to}`, "interval": "D", "theme": "dark",
                    "container_id": "tradingview_chart", "style": "3", "backgroundColor": "#05070a", "hide_top_toolbar": true
                });
            } catch(e) {}
        }

        window.onload = function() {
            const f = document.getElementById('fromCurrency'), t = document.getElementById('toCurrency');
            coins.forEach(c => { f.add(new Option(c, c)); t.add(new Option(c, c)); });
            f.value = "EUR"; t.value = "USD";
            [f, t, document.getElementById('amount')].forEach(el => el.onchange = convert);
            convert();
        }
    </script>
</body>
</html>
